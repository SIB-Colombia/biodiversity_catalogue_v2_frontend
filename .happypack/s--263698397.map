{"version":3,"sources":["src/auth/index.js"],"names":["http","isAuthenticated","me","signin","logout","setToken","getUser","setUser","clean","type","data","body","FormData","key","append","method","headers","getToken","currentUser","server","local","then","response","json","catch","user","err","window","location","reload","localStorage","getItem","TOKEN","setItem","token","JSON","parse","USER","stringify","clear"],"mappings":";;;;;QAKgBA,I,GAAAA,I;QAuBAC,e,GAAAA,e;QAUAC,E,GAAAA,E;QAYAC,M,GAAAA,M;QAYAC,M,GAAAA,M;QAWAC,Q,GAAAA,Q;QAKAC,O,GAAAA,O;QAKAC,O,GAAAA,O;QAKAC,K,GAAAA,K;;AAxFhB;;;;AACA;;;;;;AAEA;;AAEO,SAASR,IAAT,CAAcS,IAAd,EAAoBC,IAApB,EAA0B;;AAE/B,MAAIC,OAAO,IAAIC,QAAJ,EAAX;AACA,MAAIF,IAAJ,EACE,KAAK,IAAIG,GAAT,IAAgBH,IAAhB;AACEC,SAAKG,MAAL,CAAYD,GAAZ,EAAiBH,KAAKG,GAAL,CAAjB;AADF,GAGFH,OAAOA,OACHC,IADG,GAEH,IAFJ;;AAIA,SAAO;AACLI,YAAQN,IADH;AAEL;AACAO,aAAS;AACP,mCAA2B,KAAKC,QAAL;AADpB,KAHJ;AAMLN,UAAMD;AAND,GAAP;AASD;;AAED;AACO,SAAST,eAAT,GAA2B;AAChC,MAAIiB,cAAcZ,SAAlB;AACA,MAAI,KAAKW,QAAL,MAAmBC,WAAvB,EAAoC;AAClC,WAAOA,WAAP;AACD,GAFD,MAEO;AACL,WAAO,KAAP;AACD;AACF;;AAED;AACO,SAAShB,EAAT,GAAc;AACnB,SAAO,+BAAS,gBAAMiB,MAAN,CAAaC,KAAtB,mBAA2CpB,KAAK,KAAL,CAA3C,EAAwDqB,IAAxD,CAA6D,UAACC,QAAD,EAAc;AAChF,WAAOA,SAASC,IAAT,EAAP;AACD,GAFM,EAEJF,IAFI,CAEC,UAACX,IAAD,EAAU;AAChBH,YAAQG,IAAR;AACA,WAAOA,IAAP;AACD,GALM,EAKJc,KALI,CAKE,eAAO;AACdhB;AACD,GAPM,CAAP;AAQD;;AAED;AACO,SAASL,MAAT,CAAgBsB,IAAhB,EAAsB;AAC3B,SAAO,+BAAS,gBAAMN,MAAN,CAAaC,KAAtB,kBAA0CpB,KAAK,MAAL,EAAayB,IAAb,CAA1C,EAA8DJ,IAA9D,CAAmE,UAACC,QAAD,EAAc;AACtF,WAAOA,SAASC,IAAT,EAAP;AACD,GAFM,EAEJF,IAFI,CAEC,UAACX,IAAD,EAAU;AAChBL,aAASK,IAAT;AACA,WAAOA,IAAP;AACD,GALM,EAKJc,KALI,CAKE,eAAO;AACd,WAAOE,GAAP;AACD,GAPM,CAAP;AAQD;;AAED;AACO,SAAStB,MAAT,GAAkB;AACvBI;AACAmB,SAAOC,QAAP,CAAgBC,MAAhB;AACD;;AAED;AACAZ,WAAW,oBAAM;AACf,SAAOa,aAAaC,OAAb,CAAqB,gBAAMC,KAA3B,CAAP;AACD,CAFD;;AAIA;AACO,SAAS3B,QAAT,CAAkBK,IAAlB,EAAwB;AAC7BoB,eAAaG,OAAb,CAAqB,gBAAMD,KAA3B,EAAkCtB,KAAKwB,KAAvC;AACD;;AAED;AACO,SAAS5B,OAAT,GAAmB;AACxB,SAAO6B,KAAKC,KAAL,CAAWN,aAAaC,OAAb,CAAqB,gBAAMM,IAA3B,CAAX,CAAP;AACD;;AAED;AACO,SAAS9B,OAAT,CAAiBG,IAAjB,EAAuB;AAC5BoB,eAAaG,OAAb,CAAqB,gBAAMI,IAA3B,EAAiCF,KAAKG,SAAL,CAAe5B,IAAf,CAAjC;AACD;;AAED;AACO,SAASF,KAAT,GAAiB;AACtBsB,eAAaS,KAAb;AACD;;;;;;;;gCArFevC,I;;gCAuBAC,e;;gCAUAC,E;;gCAYAC,M;;gCAYAC,M;;gCAWAC,Q;;gCAKAC,O;;gCAKAC,O;;gCAKAC,K","file":"index.js","sourceRoot":"/home/leo/htdocs/biodiversity_catalogue_v2_frontend","sourcesContent":["import fetch from 'isomorphic-fetch';\nimport Const from '../const';\n\n//Http\n\nexport function http(type, data) {\n\n  var body = new FormData();\n  if (data)\n    for (var key in data)\n      body.append(key, data[key]);\n\n  data = data\n    ? body\n    : null;\n\n  return {\n    method: type,\n    // mode: 'cors',\n    headers: {\n      'Authorization': `Bearer ${this.getToken()}`\n    },\n    body: data\n  }\n\n}\n\n//is authenticated\nexport function isAuthenticated() {\n  var currentUser = getUser();\n  if (this.getToken() && currentUser) {\n    return currentUser;\n  } else {\n    return false;\n  }\n}\n\n//Me\nexport function me() {\n  return fetch(`${Const.server.local}/api/user/me`, http('GET')).then((response) => {\n    return response.json()\n  }).then((data) => {\n    setUser(data);\n    return data;\n  }).catch(err => {\n    clean();\n  })\n}\n\n//signin\nexport function signin(user) {\n  return fetch(`${Const.server.local}/auth/local`, http('POST', user)).then((response) => {\n    return response.json()\n  }).then((data) => {\n    setToken(data);\n    return data\n  }).catch(err => {\n    return err;\n  })\n}\n\n//logout\nexport function logout() {\n  clean();\n  window.location.reload();\n}\n\n//Get Token\ngetToken = () => {\n  return localStorage.getItem(Const.TOKEN);\n}\n\n//Set Token\nexport function setToken(data) {\n  localStorage.setItem(Const.TOKEN, data.token);\n}\n\n//Get User\nexport function getUser() {\n  return JSON.parse(localStorage.getItem(Const.USER));\n}\n\n//Set User\nexport function setUser(data) {\n  localStorage.setItem(Const.USER, JSON.stringify(data));\n}\n\n//Clean\nexport function clean() {\n  localStorage.clear();\n}\n"]}