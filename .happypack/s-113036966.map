{"version":3,"sources":["src/auth/index.js"],"names":["http","isAuthenticated","hasRole","me","signin","signup","logout","getToken","setToken","getUser","setUser","clean","rootUser","local","Storage","LocalStorage","type","data","body","FormData","key","append","method","headers","Promise","resolve","reject","console","log","server","then","response","json","catch","user","err","window","location","reload","localStorage","getItem","TOKEN","setItem","token","JSON","parse","USER","stringify","clear"],"mappings":"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","file":"index.js","sourceRoot":"/home/leo/htdocs/biodiversity_catalogue_v2_frontend","sourcesContent":["import fetch from 'isomorphic-fetch';\nimport Const from '../const';\nvar rootUser;\n\nthis.local = new Storage(LocalStorage)\n\n//Http\nexport function http(type, data) {\n\n  var body = new FormData();\n  if (data)\n    for (var key in data)\n      body.append(key, data[key]);\n\n  data = data\n    ? body\n    : null;\n\n  return {\n    method: type,\n    // mode: 'cors',\n    headers: {\n      'Authorization': `Bearer ${getToken()}`\n    },\n    body: data\n  }\n\n}\n\n//is authenticated\nexport function isAuthenticated() {\n  //return getUser() || false;\n  return new Promise(function(resolve, reject) {\n\n    console.log('hh', getUser());\n    resolve(getUser() || false)\n\n  })\n}\n\n//has Role\nexport function hasRole() {}\n\n//Me\nexport function me() {\n  return fetch(`${Const.server.local}/api/user/me`, http('GET')).then((response) => {\n    return response.json()\n  }).then((data) => {\n    setUser(data);\n    return data;\n  }).catch(err => {\n    clean();\n  })\n}\n\n//signin\nexport function signin(user) {\n  return fetch(`${Const.server.local}/auth/local`, http('POST', user)).then((response) => {\n    return response.json()\n  }).then((data) => {\n    setToken(data);\n    return data\n  }).catch(err => {\n    return err;\n  })\n}\n\n//signup\nexport function signup(user) {\n  return fetch(`${Const.server.local}/api/user/register`, http('POST', user)).then((response) => {\n    return response.json()\n  }).then((data) => {\n    return data\n  }).catch(err => {\n    return err;\n  })\n}\n\n//logout\nexport function logout() {\n  clean();\n  window.location.reload();\n}\n\n//Get Token\nexport function getToken() {\n  return localStorage.getItem(Const.TOKEN);\n}\n\n//Set Token\nexport function setToken(data) {\n  localStorage.setItem(Const.TOKEN, data.token);\n}\n\n//Get User\nexport function getUser() {\n  return rootUser || JSON.parse(localStorage.getItem(Const.USER));\n}\n\n//Set User\nexport function setUser(data) {\n  rootUser = data;\n  localStorage.setItem(Const.USER, JSON.stringify(data));\n}\n\n//Clean\nexport function clean() {\n  localStorage.clear();\n}\n"]}