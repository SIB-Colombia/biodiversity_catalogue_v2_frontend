{"version":3,"sources":["src/auth/index.js"],"names":["http","isAuthenticated","hasRole","me","signin","signup","logout","getToken","setToken","getUser","setUser","clean","rootUser","type","data","body","FormData","key","append","method","headers","server","local","then","response","json","catch","user","err","window","location","reload","localStorage","getItem","TOKEN","setItem","token","JSON","parse","USER","stringify","clear"],"mappings":"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","file":"index.js","sourceRoot":"/home/leo/htdocs/biodiversity_catalogue_v2_frontend","sourcesContent":["import fetch from 'isomorphic-fetch';\nimport Const from '../const';\nvar rootUser;\n\n//Http\nexport function http(type, data) {\n\n  var body = new FormData();\n  if (data)\n    for (var key in data)\n      body.append(key, data[key]);\n\n  data = data\n    ? body\n    : null;\n\n  return {\n    method: type,\n    // mode: 'cors',\n    headers: {\n      'Authorization': `Bearer ${getToken()}`\n    },\n    body: data\n  }\n\n}\n\n//is authenticated\nexport function isAuthenticated() {\n  return getUser() || false;\n}\n\n//has Role\nexport function hasRole() {}\n\n//Me\nexport function me() {\n  return fetch(`${Const.server.local}/api/user/me`, http('GET')).then((response) => {\n    return response.json()\n  }).then((data) => {\n    setUser(data);\n    return data;\n  }).catch(err => {\n    clean();\n  })\n}\n\n//signin\nexport function signin(user) {\n  return fetch(`${Const.server.local}/auth/local`, http('POST', user)).then((response) => {\n    return response.json()\n  }).then((data) => {\n    setToken(data);\n    return data\n  }).catch(err => {\n    return err;\n  })\n}\n\n//signup\nexport function signup(user) {\n  return fetch(`${Const.server.local}/api/user/register`, http('POST', user)).then((response) => {\n    return response.json()\n  }).then((data) => {\n    return data\n  }).catch(err => {\n    return err;\n  })\n}\n\n//logout\nexport function logout() {\n  clean();\n  window.location.reload();\n}\n\n//Get Token\nexport function getToken() {\n  return localStorage.getItem(Const.TOKEN);\n}\n\n//Set Token\nexport function setToken(data) {\n  localStorage.setItem(Const.TOKEN, data.token);\n}\n\n//Get User\nexport function getUser() {\n  return rootUser || JSON.parse(localStorage.getItem(Const.USER));\n}\n\n//Set User\nexport function setUser(data) {\n  rootUser = data;\n  localStorage.setItem(Const.USER, JSON.stringify(data));\n}\n\n//Clean\nexport function clean() {\n  localStorage.clear();\n}\n"]}